---
id: a-day-in-the-life-of-milvus-datum.md
title: يوم في حياة ميلفوس داتوم
author: 'Stefan Webb, Anthony Tu'
date: 2025-03-17T00:00:00.000Z
desc: لذا، دعونا نأخذ جولة في يوم من حياة ديف، مسند ميلفوس.
cover: assets.zilliz.com/a_day_in_the_life_of_a_milvus_datum_ca279f7f59.png
tag: Engineering
tags: 'Deep Research, open source AI, Milvus, LangChain, DeepSeek R1'
recommend: true
canonicalUrl: 'https://milvus.io/blog/a-day-in-the-life-of-milvus-datum.md'
---
<p>إن بناء <a href="https://zilliz.com/learn/what-is-vector-database">قاعدة بيانات متجهات</a> فعّالة مثل Milvus التي تتسع لمليارات المتجهات وتتعامل مع حركة المرور على نطاق الويب ليس بالأمر السهل. فهو يتطلب تصميمًا دقيقًا وذكيًا لنظام موزع. بالضرورة، ستكون هناك مفاضلة بين الأداء مقابل البساطة في الأجزاء الداخلية لنظام كهذا.</p>
<p>وعلى الرغم من أننا حاولنا الموازنة بين هذه المفاضلة بشكل جيد، إلا أن بعض جوانب الأجزاء الداخلية ظلت مبهمة. تهدف هذه المقالة إلى تبديد أي غموض حول كيفية تقسيم ميلفوس لإدخال البيانات وفهرستها وتقديمها عبر العقد. يعد فهم هذه العمليات على مستوى عالٍ أمرًا ضروريًا لتحسين أداء الاستعلام واستقرار النظام والمشكلات المتعلقة بتصحيح الأخطاء بشكل فعال.</p>
<p>لذا، لنأخذ جولة في يوم في حياة ديف، مسند ميلفوس. تخيل أنك أدرجتَ ديف في مجموعتك في <a href="https://milvus.io/docs/install-overview.md#Milvus-Distributed">عملية نشر Milvus الموزعة</a> (انظر الرسم البياني أدناه). بالنسبة لك، فإنه يدخل مباشرةً في المجموعة. لكن خلف الكواليس، تحدث العديد من الخطوات عبر أنظمة فرعية مستقلة.</p>
<p>
  <span class="img-wrapper">
    <img translate="no" src="https://assets.zilliz.com/a_day_in_the_life_of_a_milvus_datum_ca279f7f59.png" alt="" class="doc-image" id="" />
    <span></span>
  </span>
</p>
<h2 id="Proxy-Nodes-and-the-Message-Queue" class="common-anchor-header">العقد الوكيل وقائمة انتظار الرسائل<button data-href="#Proxy-Nodes-and-the-Message-Queue" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>
  <span class="img-wrapper">
    <img translate="no" src="https://assets.zilliz.com/Proxy_Nodes_and_the_Message_Queue_03a0fde0c5.png" alt="" class="doc-image" id="" />
    <span></span>
  </span>
</p>
<p>في البداية، تقوم باستدعاء كائن MilvusClient، على سبيل المثال، عبر مكتبة PyMilvus، وإرسال طلب <code translate="no">_insert()</code>_ إلى <em>عقدة وكيل</em>. العقد البروكسي هي البوابة بين المستخدم ونظام قاعدة البيانات، حيث تقوم بعمليات مثل موازنة التحميل على حركة المرور الواردة وتجميع مخرجات متعددة قبل إرجاعها إلى المستخدم.</p>
<p>تُطبَّق دالة تجزئة على المفتاح الأساسي للعنصر لتحديد <em>القناة</em> التي يجب إرساله إليها. تمثّل القنوات، التي يتم تنفيذها إما بمواضيع بولسار أو كافكا، مكانًا لحفظ البيانات المتدفقة، والتي يمكن إرسالها بعد ذلك إلى المشتركين في القناة.</p>
<h2 id="Data-Nodes-Segments-and-Chunks" class="common-anchor-header">عُقَد البيانات والمقاطع والقطع<button data-href="#Data-Nodes-Segments-and-Chunks" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>
  <span class="img-wrapper">
    <img translate="no" src="https://assets.zilliz.com/Data_Nodes_Segments_and_Chunks_ae122dd1ac.png" alt="" class="doc-image" id="" />
    <span></span>
  </span>
</p>
<p>بعد أن يتم إرسال البيانات إلى القناة المناسبة، تقوم القناة بعد ذلك بإرسالها إلى المقطع المقابل في <em>عقدة البيانات</em>. عقد البيانات مسؤولة عن تخزين وإدارة المخازن المؤقتة للبيانات التي تسمى المقاطع <em>المتزايدة</em>. هناك مقطع متزايد واحد لكل جزء.</p>
<p>عندما يتم إدراج البيانات في مقطع، ينمو المقطع نحو الحد الأقصى للحجم، افتراضيًا إلى 122 ميغابايت. خلال هذا الوقت، يتم دفع أجزاء أصغر من المقطع، افتراضيًا 16 ميغابايت والمعروفة باسم <em>القطع،</em> إلى التخزين الدائم، على سبيل المثال، باستخدام S3 من AWS أو أي وحدة تخزين متوافقة أخرى مثل MinIO. كل جزء هو ملف فعلي على وحدة تخزين الكائنات ويوجد ملف منفصل لكل حقل. انظر الشكل أعلاه الذي يوضح التسلسل الهرمي للملفات على وحدة تخزين الكائنات.</p>
<p>للتلخيص، يتم تقسيم بيانات المجموعة عبر عقد البيانات، حيث يتم تقسيمها إلى أجزاء للتخزين المؤقت، والتي يتم تقسيمها أيضًا إلى أجزاء لكل حقل للتخزين الدائم. يوضح الرسمان البيانيان أعلاه هذا الأمر بشكل أوضح. من خلال تقسيم البيانات الواردة بهذه الطريقة، فإننا نستغل بشكل كامل توازي الكتلة في عرض النطاق الترددي للشبكة والحساب والتخزين.</p>
<h2 id="Sealing-Merging-and-Compacting-Segments" class="common-anchor-header">ختم ودمج ودمج وضغط المقاطع<button data-href="#Sealing-Merging-and-Compacting-Segments" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>
  <span class="img-wrapper">
    <img translate="no" src="https://assets.zilliz.com/Sealing_Merging_and_Compacting_Segments_d5a6a37261.png" alt="" class="doc-image" id="" />
    <span></span>
  </span>
</p>
<p>لقد سردنا حتى الآن قصة كيف يشقّ مسندنا الودود ديف طريقه من استعلام <code translate="no">_insert()</code>_ إلى التخزين الدائم. بالطبع، لا تنتهي قصته عند هذا الحد. هناك خطوات أخرى لجعل عملية البحث والفهرسة أكثر كفاءة. من خلال إدارة حجم وعدد المقاطع وعددها، يستغل النظام بشكل كامل توازي الكتلة.</p>
<p>بمجرد أن يصل حجم المقطع إلى الحد الأقصى لحجمه على عقدة البيانات، افتراضيًا 122 ميغابايت، يُقال إنه تم <em>إغلاقه</em>. ما يعنيه هذا هو أن المخزن المؤقت على عقدة البيانات يتم مسحه لإفساح المجال لمقطع جديد، ويتم وضع علامة على القطع المقابلة في التخزين الدائم على أنها تنتمي إلى مقطع مغلق.</p>
<p>تبحث عُقد البيانات بشكل دوري عن المقاطع المغلقة الأصغر حجمًا وتدمجها في مقاطع أكبر حتى تصل إلى حجم أقصى يبلغ 1 جيجابايت (افتراضيًا) لكل مقطع. تذكر أنه عندما يتم حذف عنصر ما في ميلفوس، يتم ببساطة تمييزه بعلامة حذف - فكر في الأمر على أنه صف الموت لديف. عندما يتجاوز عدد العناصر المحذوفة في مقطع ما عتبة معينة، افتراضيًا 20%، يتم تقليل حجم المقطع، وهي عملية نسميها <em>الضغط</em>.</p>
<p>الفهرسة والبحث في المقاطع</p>
<p>
  <span class="img-wrapper">
    <img translate="no" src="https://assets.zilliz.com/Indexing_and_Searching_through_Segments_478c0067be.png" alt="" class="doc-image" id="" />
    <span></span>
  </span>
</p>
<p>
  <span class="img-wrapper">
    <img translate="no" src="https://assets.zilliz.com/Indexing_and_Searching_through_Segments_1_0c31b5a340.png" alt="" class="doc-image" id="" />
    <span></span>
  </span>
</p>
<p>هناك نوع عقدة إضافية، وهي <em>عقدة الفهرس،</em> وهي مسؤولة عن بناء فهارس للمقاطع المختومة. عندما يتم إغلاق المقطع، ترسل عقدة البيانات طلبًا لعقدة الفهرس لإنشاء فهرس. ثم ترسل عقدة الفهرس الفهرس المكتمل إلى مخزن الكائنات. يحتوي كل مقطع مغلق على فهرس خاص به مخزن في ملف منفصل. يمكنك فحص هذا الملف يدويًا عن طريق الوصول إلى الدلو - انظر الشكل أعلاه لمعرفة التسلسل الهرمي للملف.</p>
<p>تشترك عقد الاستعلام - وليس عقد البيانات فقط - في مواضيع طابور الرسائل للمقاطع المقابلة. يتم نسخ الأجزاء المتنامية على عقد الاستعلام، وتقوم العقدة بتحميل الأجزاء المغلقة في الذاكرة التي تنتمي إلى المجموعة حسب الحاجة. تقوم ببناء فهرس لكل شريحة متنامية عند ورود البيانات، وتحمّل الفهارس النهائية للشرائح المختومة من مخزن البيانات.</p>
<p>تخيل الآن أنك تستدعي كائن MilvusClient بطلب <em>بحث()</em> يشمل ديف. بعد توجيهه إلى جميع عقد الاستعلام عبر عقدة الوكيل، تقوم كل عقدة استعلام بإجراء بحث تشابه متجه (أو أي طريقة أخرى من طرق البحث مثل الاستعلام أو البحث في النطاق أو البحث في التجميع)، مع التكرار على المقاطع واحدة تلو الأخرى. يتم تجميع النتائج عبر العُقد بطريقة تشبه MapReduce وإرسالها إلى المستخدم، ويسعد ديف أن يجد نفسه قد اجتمع بك أخيرًا.</p>
<h2 id="Discussion" class="common-anchor-header">المناقشة<button data-href="#Discussion" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>لقد قمنا بتغطية يوم في حياة ديف المسند، لكل من عمليتي <code translate="no">_insert()</code>_ و <code translate="no">_search()</code>_. عمليات أخرى مثل <code translate="no">_delete()</code>_ و <code translate="no">_upsert()</code>_ تعمل بالمثل. اضطررنا حتمًا إلى تبسيط مناقشتنا وحذف التفاصيل الدقيقة. على العموم، على الرغم من ذلك، يجب أن تكون لديك الآن صورة كافية عن كيفية تصميم Milvus للتوازي عبر العقد في نظام موزع ليكون قويًا وفعالًا، وكيف يمكنك استخدام ذلك للتحسين وتصحيح الأخطاء.</p>
<p><em>خلاصة مهمة من هذه المقالة: تم تصميم Milvus مع فصل الاهتمامات عبر أنواع العقد. كل نوع عقدة لها وظيفة محددة وحصرية متبادلة، وهناك فصل بين التخزين والحساب.</em> والنتيجة هي أنه يمكن توسيع نطاق كل مكون بشكل مستقل مع معلمات قابلة للتعديل وفقًا لحالة الاستخدام وأنماط حركة المرور. على سبيل المثال، يمكنك توسيع نطاق عدد عقد الاستعلام لخدمة حركة المرور المتزايدة دون توسيع نطاق البيانات وعقد الفهرس. وبفضل هذه المرونة، هناك مستخدمو Milvus الذين يتعاملون مع مليارات المتجهات ويخدمون حركة مرور البيانات على نطاق الويب، مع زمن استجابة استعلام أقل من 100 مللي ثانية.</p>
<p>يمكنك أيضًا الاستمتاع بمزايا تصميم Milvus الموزع دون حتى نشر مجموعة موزعة من خلال <a href="https://zilliz.com/cloud">Zilliz Cloud،</a> وهي خدمة مُدارة بالكامل من Milvus. <a href="https://cloud.zilliz.com/signup">اشترك اليوم للحصول على المستوى المجاني من Zilliz Cloud مجانًا وضع ديف موضع التنفيذ!</a></p>
